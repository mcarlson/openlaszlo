<html xmlns="http://www.w3.org/1999/xhtml">
<head>
</head>
<body>

<!-- ===================================================================== -->
<!-- = XML information goes here                                         = -->
<!-- ===================================================================== -->
<lzelement title="LzEvent">
    <lztier>LFC</lztier>
    <lzcategory>Event</lzcategory>
    <lzshortdesc>
        The sender in Laszlo's point-to-point event system.
    </lzshortdesc>
    <lzapi>api-lzevent.xml</lzapi>
    <seealso>delegate</seealso>
</lzelement>

<p>Events underly most of the functionality in OpenLaszlo  applications. 
Unlike events in similar systems, OpenLaszlo's events are point-to-point, meaning that there is no general broadcast mechanism for events, and events do not trickle up or down the instance hierarchy. Instead, objects called <a href="delegate.html">delegates</a> <a href="delegate.html#meth-register">register</a> for events, and if they try to register for an event that doesn't exist yet, the system creates the event. </p>
<p>You can create a delegate explicitly using the <classname link="true">LzDelegate</classname> class, or implicitly by creating an handler.</p>
<p>
Because of the loose type requirements in LZX, calling an event that no delegate is listening for (and which therefore hasn't been created) has no effect. This allows objects to publish many more events than they actually need to create at runtime.
</p>

<p>There are two syntaxes with which you can specify an event handler: in the tag used to create that object, or by using the 
<tagname link="true">handler</tagname> tag.</p>

<p>To specify an event handler in an object-creation tag, simply include it like any other attribute.  For example,</p>

<example class="code" extract="false">
&lt;view onMouseOver="doSomething()"&gt;
  &lt;method name="doSomething"&gt;
    // code to be executed when mouse is over the view
  &lt;/method&gt;
&lt;/view&gt;
</example>

<p>If you use the <tagname link="true">handler</tagname> tag, you do not need to include the handler in the tag that creates the object.</p>

<example class="code" extract="false">
&lt;view&gt;
 &lt;handler name="onMouseOver"&gt;
   // code to be executed when the mouse is over the view
 &lt;/name&gt;
&lt;/view&gt;
</example>

<p> The above two examples are functionally equivalent.  Using the <tagname>handler</tagname> tag, however, can often lead to more readable code because it removes clutter from the object creation tag.</p> 

<p>Use the <tagname link="true">event</tagname> tag to create the events; then use the <method>sendEvent</method> method to dispatch it. The following example illustrates how to create custom events.</p>

<example class="program"
         title="A simple example of publishing and listening for a custom event">
&lt;canvas height="40"&gt;
  &lt;simplelayout/&gt;
  &lt;button name="eventSender" 
          <em>onmouseover="this.customevent.sendEvent()"
          onmouseout="this.customevent.sendEvent()"/&gt;</em>
  &lt;event name="customevent"/&gt;
  &lt;view bgcolor="red" width="20" height="20" oninit="this.setupDelegate()"&gt;
    &lt;method name="setupDelegate"&gt;
      this.del = new LzDelegate( this, "respondToEvent" );
      <em>this.del.register( eventSender , "customevent" );</em>
    &lt;/method&gt;
    &lt;method name="respondToEvent"&gt;
      this.setAttribute('x', this.x + 10);
    &lt;/method&gt;
  &lt;/view&gt;
&lt;/canvas&gt;
</example>

<p>
Events can be sent with a single argument, which usually conveys information about the property that changed. The default behavior of the <a href="node.html#meth-setAttribute">setAttribute</a> method is to set the named property and send the event called "on" + property. This is general mechanism that updates constraints in a OpenLaszlo programs. For instance, when a view changes its <attribute>x</attribute> position, it sends the event <event>onx</event> with the new value for its <attribute>x</attribute> property.
</p>

<example class="program"
         title="Event sending in response to setting an attribute">
&lt;canvas height="40"&gt;
  &lt;simplelayout/&gt;
  &lt;button name="eventSender" 
          <em>onmouseover="this.setAttribute('avalue', this.avalue + 10)"
          onmouseout="this.setAttribute('avalue', this.avalue + 5)"</em>&gt;
    &lt;attribute name="avalue" value="0"/&gt;
  &lt;/button&gt;
  &lt;view bgcolor="red" width="20" height="20" oninit="this.setupDelegate()"&gt;
    &lt;method name="setupDelegate"&gt;
      this.del = new LzDelegate(this, "respondToEvent");
      this.del.register(eventSender, <em>"onavalue"</em>);
    &lt;/method&gt;
    &lt;method name="respondToEvent" args="v"&gt;
      this.setAttribute('x' , v);
    &lt;/method&gt;
  &lt;/view&gt;
&lt;/canvas&gt;
</example>

</body>
</html>
<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
