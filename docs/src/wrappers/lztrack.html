<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="STYLESHEET" type="text/css" href="./styles.css" /></head>
<body>

<!-- ===================================================================== -->
<!-- = XML information goes here                                         = -->
<!-- ===================================================================== -->
<lzelement title="LzTrack">
    <lztier>Service</lztier>
    <lzcategory>Event</lzcategory>
    <lzshortdesc>
        Enables tracking mouse events over a group of views.
    </lzshortdesc>
    <lzapi>api-lztrack.xml</lzapi>
</lzelement>

<p>This service helps tracking the mouse over a number of views, as in
common when implementing menus and drag-and-drop behaviors.  When the
mouse is down, standard view events such as <event>ondragin</event>
and <event>ondragout</event> are only sent to the view which received
the onmousedown events.  When views are registered using the
<classname>LzTrack</classname> service, they will receive events
independent of the mouse button state.
</p>
<p>
In using LzTrack, views register with a particular group.
Activation of that group is typically triggered by a user event.  When a group
is active, the LzTrack service will events to views in the active group, whenever
the mouse position enters (<event>ontrackover</event>), leaves (<event>ontrackout</event>) or when the mouse
button goes up (<event>ontrackup</event>).
</p>

<h2>Example: a simple color picker</h2>
<p>
This simple color picker displays its color in a rectangle, then
when the mouse is down over the colored rectangle, a series of colors are
displayed (as displayed below).  While the mouse is down, the user may move
the mouse across the color choices.  When the mouse button goes up over a
color, that color is selected and the color menu disappears.
</p>
<!--
<img src="images/lztrack/colorpicker.gif" width="131" height="42" />
-->
<p>The code below defines the class "colorspot" which represents a
tracked view.  This class handles visual state changes triggered by
the track events and sends an event to its parent when a new color is
selected.  <method>LzTrack.register</method> is called by
<event>oninit</event> to add the instance of the view to its group.
The group name is defined as an attribute of the class, but simply
bound to an attribute of the parent.  For simple menu tracking, it is
typical for a set of sibling views to share the same track group;
however, tracked views that share the same trackgroup may be anywhere
in view hierarchy.</p>

<example title="Using LzTrack to build a color chooser">
&lt;canvas height="60"&gt;
  &lt;class name="colorspot" clickable="true"
    width="22" height="22" bgcolor="0x000000"&gt;
    &lt;attribute name="mycolor"/&gt;
    &lt;attribute name="trackgroup" type="string" value="${parent.trackgroup}"/&gt;
    &lt;view name="spot" bgcolor="${parent.mycolor}"
        x="2" y="2" width="18" height="18"/&gt;
    &lt;method event="oninit"&gt;
        LzTrack.register(this, this.trackgroup);
    &lt;/method&gt;
    &lt;method event="onmousetrackover"&gt;
        setAttribute('bgcolor', 0xdedede); // hilite: gray
    &lt;/method&gt;
    &lt;method event="onmousetrackout"&gt;
        setAttribute('bgcolor', 0x000000); // normal: black
    &lt;/method&gt;
    &lt;method event="onmousetrackup"&gt;
        parent.onnewcolor.sendEvent(this.spot.bgcolor);
    &lt;/method&gt;
  &lt;/class&gt;

  &lt;view bgcolor="0x0000ff" width="20" height="20"
      onmousedown="this.colorpicker.setVisible(true); LzTrack.activate('mymenu');"
      onmouseup="this.colorpicker.setVisible(false); LzTrack.deactivate('mymenu');"&gt;
    &lt;view name="colorpicker" visible="false" x="10" y="10"&gt;
      &lt;attribute name="trackgroup" value="mymenu" type="string"/&gt;
      &lt;method event="onnewcolor" args="newcolor"&gt;
          parent.setAttribute('bgcolor', newcolor);
      &lt;/method&gt;

      &lt;simplelayout axis="x"/&gt;
      &lt;colorspot mycolor="0x0000ff"/&gt;
      &lt;colorspot mycolor="0x00ff00"/&gt;
      &lt;colorspot mycolor="0xffff00"/&gt;
      &lt;colorspot mycolor="0xff0000"/&gt;
      &lt;colorspot mycolor="0x00ffff"/&gt;
    &lt;/view&gt;
  &lt;/view&gt;
  &lt;text&gt;Click on the square, then release the mouse button to select a new color.&lt;/text&gt;
  &lt;simplelayout axis="y" spacing="20"/&gt;
&lt;/canvas&gt;
</example>

</body>
</html>
<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
