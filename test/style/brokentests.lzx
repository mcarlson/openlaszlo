<!-- Copyright 2006 Laszlo Systems --> 
<library>

<script src="seeit_css.js" />

<class name="designerview"
    width="50" height="50" >
    
    <!-- List the attributes which will be styled by CSS --> 
    <attribute name="propsFromCSS" 
        value="['width', 'height', 'nonsense', 
            'borderwidth', 'bordercolor', 'textinset','innercolor',
            'bgcolor', 'fgcolor',
            'labelcolor']" />
    

    <handler name="onconstruct" method="_applyCSS" />
    
    <method name="init">
        super.init();
    </method>
    
    <method name="_applyCSS">
        // Look up the style
        var mystyle = LzCSSStyle.getComputedStyle( this );
        if (mystyle != null) {
            for (var i in this.propsFromCSS) {
                var propertyName = this.propsFromCSS[i];
                var v = mystyle.getPropertyValue( propertyName ); 
                if (v != null) 
                    this.setAttribute(propertyName, v);
            }
        }
    </method>
    
    <attribute name="borderwidth" value="10" />
    <attribute name="textinset" value="2" />    
    <attribute name="innercolor" value="0xb4a88f" />
    <attribute name="bordercolor" value="0x652f15" />
    <attribute name="labelcolor" value="black" />    
    <view name="outerborder" width="100%" height="100%" 
        bgcolor="${classroot.bordercolor}">
        <view name="innerbox" 
            x="${classroot.borderwidth}" 
            y="${classroot.borderwidth}"
            width="${parent.width-2*this.x}"
            height="${parent.height-2*this.y}"
            bgcolor="${classroot.innercolor}">
            <text x="${classroot.textinset}"
                fgcolor="${classroot.labelcolor}"
                fontsize="9"
                y="${classroot.textinset}" 
                name="txt" text="${classroot.id}" />
        </view>
    </view>
</class>

<designerview name="gDV7" />

<testsuite name="textproperties" loglevel="log">
    <handler name="oninit">
        this.addTest( "styleTextProperties"); 
        this.run();
    </handler>

<!-- This test fails, which is interesting. The color *appears* properly in the 
     visual representation, but the data structure says that the innerbox's fgcolor
     is null. Is this a problem with my implementation, or with text colors in general? 
     I think it's text colors in general. [bshine 7.21.2006]
     -->
<method name="styleTextProperties">
    this.assertEquals( "gDV7", gDV7.outerborder.innerbox.txt.text); 
    this.assertEquals( 0xFF0000, gDV7.outerborder.innerbox.txt.getAttribute("fgcolor"));
    this.finishedTest( "styleTextProperties" ); 
</method>     
</testsuite>


</library>