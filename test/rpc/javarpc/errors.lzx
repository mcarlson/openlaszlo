<canvas width="800" height="600" debug="true">

    <!-- Test case for propagation of errors generated by the backend-->

    <debug x="300" y="20" width="500" height="400" />
    
    <simplelayout spacing="10"/>
    
    <security>
        <allow>
            <pattern>^org\.openlaszlo\.test\.xmlrpc\.ServerErrors$</pattern>
        </allow>
    </security>

    <javarpc name="errors" scope="session" autoload="false" loadoption="create"
             remoteclassname="org.openlaszlo.test.xmlrpc.ServerErrors">
        
        <!-- handlers -->
        <method event="onerror" args="errmsg">
            Debug.write('onerror:', errmsg)
        </method>
        
        <method event="onload">
            Debug.write('onload:', this.proxy);
        </method>        

        <!-- declare remote calls -->
        <remotecall funcname="makeException"/>

        <remotecall funcname="forceTimeout">
            <method event="ondata" args="msg">
                Debug.write("returned from forceTimeout: " + msg)
            </method>
        </remotecall>
        
        <remotecall funcname="invokeMe">
            <method event="ondata" args="msg">
                Debug.write("invokeMe returned: " + msg)
            </method>
        </remotecall>        
        
        <remotecall funcname="noAccess"/>
        
    </javarpc>
    

    <button text="Create (should work)" onclick="errors.load({foo: 100, bar: 'blah'})"/>
    
    <button text="Create (should work)" onclick="errors.load()"/>

    <button text="Create (should fail)" onclick="errors.load('foo')"/>

    <button text="make exception" onclick="errors.makeException.invoke()"/>
    
    <button text="call non-method" onclick="errors.invokeMe.invoke( [ true ] )"/>
    
    <button text="non-public method" onclick="errors.noAccess.invoke()"/>

    <view>
        <simplelayout axis="x" spacing="5"/>
        <edittext name="input">enter number</edittext>
        <button text="force timeout" 
                onclick="errors.forceTimeout.invoke( [ parent.input.text ] )"/>
    </view>

<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2007 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
</canvas>
