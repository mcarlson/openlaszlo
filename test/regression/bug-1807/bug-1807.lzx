<canvas>
    <!-- Request dataset -->
    <dataset name="requestData" src="testdata.xml" type="http" 
             getresponseheaders="false"  request="false"
             ondata="relobutt.waitnload();"/>
             
    <!-- requested data is copied here -->
    <dataset name="rebuildData">
        <data/>
    </dataset>

    <datapointer xpath="requestData:/data/video" ondata="this.parent.handleData( this )" />

    <datapointer name="rebuildPointer" xpath="rebuildData:/data" />

    <method name="handleData" args="dp">
    <![CDATA[
        if ( !dp || dp == null ) return;
        if ( dp.getNodeName() != 'video' ) return;

        //Debug.write('handleData: ' + dp.serialize() ); 
        this.rebuildPointer.setXPath( "rebuildData:/data/video" ); 
        if (this.rebuildPointer.getNodeName() == 'video') {
            //Debug.write('Before delete: ' +  this.rebuildPointer.serialize() );
            this.rebuildPointer.deleteNode();
        }
        this.rebuildPointer.setXPath( "rebuildData:/data" );
        //Debug.write('Before add: ' + this.rebuildPointer.serialize() );
        this.rebuildPointer.addNodeFromPointer( dp );
        //Debug.write('After add: ' +  this.rebuildPointer.serialize() );
    ]]>
    </method>
   
    <simplelayout/>
    <text text="${relobutt.relocnt}"/>
    <view id="relobutt" width="100" height="40" bgcolor="silver"
          clickable="true"><text>Click to start</text>
        <attribute name="relocnt" value="0"/>
        <attribute name="icnt" value="0"/>
        <method name="waitnload" event="onclick">
        <![CDATA[
            if (! this.waitDel) this.waitDel = new LzDelegate(parent.requestData, 'doRequest');
            this.setAttribute( 'relocnt' , this.relocnt+1 );
            LzTimer.addTimer(this.waitDel, 1000);
        ]]>
        </method>
    </view>


</canvas>

<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
