<canvas  bgcolor="#EAEAEA" width="640" height="540" debug="true">

    <script>
        canvas.counter1 = 0;
        canvas.counter2 = 0;
        canvas.maxTest = 5;
    </script>

    <connection receiveuserdisconnect="false" authenticator="anonymous" />

    <connectiondatasource name="myconnection">

        <dataset name="message" />
        <dataset name="userconnect" />

        <method event="onconnect">
        <![CDATA[
            Debug.write('connected ' + canvas.counter1);
        ]]>
        </method>

        <method event="ondisconnect">
        <![CDATA[
            Debug.write('disconnected ' + canvas.counter2);
        ]]>
        </method>

    </connectiondatasource>

    <datapointer xpath="myconnection:message:/*">
        <method event="ondata"> 
            var from = this.xpathQuery('/from[0]/@name');
            var mesg = this.xpathQuery('/text()');
            Debug.write(from + ": " + mesg);
        </method>
    </datapointer>

    <view name="buttons" y="150">
        <simplelayout axis="x" spacing="5" />

        <button>Connect
            <method event="onclick">
                canvas.connection.connect();
            </method>
        </button>

        <button>Disconnect
            <attribute name="count" value="0" type="number"/>
            <method event="onclick">
                canvas.connection.disconnect();
            </method>
        </button>

        <button>Message
            <attribute name="count" value="0" type="number"/>
            <method event="onclick">
                canvas.myconnection.sendMessage("*", "testing connection", "message");
            </method>
        </button>

    </view>

<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
</canvas>
