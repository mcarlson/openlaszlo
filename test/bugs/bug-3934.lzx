<canvas width="700" height="200">

<dataset name="chatDset">
	<chatdata/>
</dataset>

<window title="Chat Mockup Window" resizable="true" name="chatWindow" width="450" height="200" 
	x="$once{canvas.width - this.width}" y="$once{canvas.height - this.height}">

    <view id="viewChat" width="${parent.width}" height="${parent.height}" x="0" y="0" bgcolor="${parent.bgcolor}"> 
        
        <datapointer name="chatPtr" xpath="chatDset:/chatdata" rerunxpath="true"/>

        <view width="352" height="107" x="4" y="4" bgcolor="#000000" />
        <view name="chatView" width="350" height="105" x="5" y="5" bgcolor="#ffffff" clip="true">
        	<attribute name="iter" value="1" when="once"/>
            <view name="svpar">
				<method name="adjustScroll">
				<![CDATA[
					if (this.parent.height < 0) return;
						var cvDif=this.parent.height-this.height;
						if ((cvDif) < 0){
							this.setY(cvDif);
							this.parent.scrollbar.updateThumbPos();
						}
					]]>
				</method>
                <view name="sview" oninit="this.parent.adjustScroll();">
                    <datapath xpath="chatDset:/chatdata/message" />

                    <text width="${parent.parent.parent.width}" multiline="true" 
                          selectable="true" datapath="text()" />
                </view>
                <simplelayout axis="y" spacing="2"/>
            </view>
            <scrollbar name="scrollbar" axis="y"/>

			<method name="appendMsg">
				if (iter++ % 20 == 0)
				{
                	var dp = chatDset.getPointer()
                	dp.selectChild()
                	dp.deleteNode()
                	chatDset.getPointer().addNode('chatdata')
				}
				else {
					with (viewChat.chatPtr)
					{
						addNode("message", (new Date()).toString());
						for (var n = 4; n &gt; 0; n--)
							addNode("message", 'message ' + n);
						addNode("message", "TOTAL ==> " + getNodeCount())
					}
				}
				LzTimer.addTimer( this.del, 2000 );
			</method>
			
			<method event="oninit">
			  this.del = new LzDelegate ( this, "appendMsg");
			  del.execute()
			</method>

        </view>

    </view> <!-- viewChat -->

</window>

</canvas>
<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
