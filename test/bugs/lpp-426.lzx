<canvas width="100%" height="100%">
    <debug x="5%" y="30%" height="65%" width="90%" oninit="this.ShowInternalProperties=true" />
   <dataset name="mydata">
       <item name="foo" flagged="0"/>
       <item name="foo" flagged="1"/>
       <item name="foo" flagged="0"/>
   </dataset>
    
<simplelayout/>

<text>three views mapped to items in mydata</text>
<view>
    <simplelayout/>
    <view datapath="mydata:/item/">
        <view width="100" height="10" datapath="@flagged">
            <method name="applyData" args="d">
                if (d == "1") {
                    setBGColor(0xffff00);
                } else {
                    setBGColor(0x4444ff);
                }
            </method>
        </view>
    </view>
</view>

<text>one view mapped an item in mydata</text>
<view id="v">
    <datapath/>
   <view width="10" id="t" height="10" datapath="@flagged">
        <method name="applyData" args="d">
                Debug.format( "ad: %#w\n", datapath.p );
                if (d == "1") {
                    setBGColor(0xffff00);
                } else {
                    setBGColor(0x4444ff);
                }
        </method>
    </view>
</view>
<button text="setdata">
    <method event="onclick">
       v.datapath.setPointer(mydata.childNodes[1]);
    </method>
</button>
<button text="setAttr">
    <method event="onclick">
        mydata.childNodes[1].setAttr('flagged', '0');
        Debug.format('data node = %#w\n', mydata.childNodes[1]);
    </method>
</button>
    <method event="onDocumentChange" reference="mydata" args="cp">
        Debug.format( 'doc change: %#w\n' , cp );
    </method>

<text multiline="true">
Adam's test: clicking on poke should cause two Debug.writes
identifying the datapointers and saying 'some text'.
</text>

    <dataset name="ds">
        <foo>
            <bar>start<harder/>
            </bar>
        </foo>
    </dataset>

    <button text="poke" onclick="dp1.poke()"/>

    <datapointer name="dp1" xpath="ds:/foo/bar">
        <method name="poke">
            this.setNodeText( "some text" );
        </method>
    </datapointer>

    <datapointer xpath="ds:/foo/bar/text()">
        <method event="ondata">
            Debug.format("%#w %#w\n", this, this.data );
        </method>
    </datapointer>
    <datapointer xpath="ds:/foo/bar/harder/../text()">
        <method event="ondata">
            Debug.format("%#w %#w\n", this, this.data );
        </method>
    </datapointer>

</canvas>

