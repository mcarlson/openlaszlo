<canvas width="790" height="540" bgcolor="0xEAEAEA" debug="true">
  <script>
    var boxes= new Array();
  </script>
  
  <class name="box" >
    <attribute name="lineColor"/>
    <attribute name="internalOpacity"/>
    <attribute name="bodyColor"/>
    <view name="tLine" bgcolor="${parent.lineColor}" width="${parent.width}" height="1"/>
    <view name="lLine" bgcolor="${parent.lineColor}" width="1" height="${parent.height}"/>
    <view name="rLine" bgcolor="${parent.lineColor}" x="${parent.width}" width="1" height="${parent.height}"/>
    <view name="bLine" bgcolor="${parent.lineColor}" y="${parent.height}" width="${parent.width}" height="1"/>
    <view name="body" opacity="${parent.internalOpacity}" width="${parent.width}" height="${parent.height}" bgcolor="${parent.bodyColor}"/>
    <method name="startResize">
      // set distances from right and bottom edges
      this.resizeOffsetX = this.getAttribute( 'width' ) - this.getMouse( 'x' );
      this.resizeOffsetY = this.getAttribute( 'height' ) - this.getMouse( 'y' );
      
      if ( !this.getAttribute('sizerDel') ) {
        this.sizerDel = new LzDelegate( this, 'adjustSize', LzIdle, 'onidle' );
      }
    </method>
    <method name="adjustSize">
      <![CDATA[
        this.setAttribute('width', this.getMouse( 'x' ));
        this.setAttribute('height',this.getMouse( 'y' ));
      ]]>
    </method>
    
    <method name="stopResize">
      this.sizerDel.unregisterAll();
      this.sizerDel = null;
    </method>
  </class>
  <view width="${canvas.width}" height="${canvas.height}" clickable="true">
    <method event="onmousedown"> 
      boxes.push(new box(canvas, { x:this.getMouse( 'x' ),
                                   y:this.getMouse( 'y' ),
                                   lineColor: 0xFF0000,
                                   bodyColor: 0xFF5555,
                                   internalOpacity: .1
                                  }));
      boxes[boxes.length-1].startResize();
    </method>
    <method event="onmouseup">
      boxes[boxes.length-1].stopResize();
    </method> 
  </view>
  <!-- bad -->
  <button text="clear" onclick="boxes.length=0"/>
  <!-- good
  <button label="clear" onclick="for (var i=0; i!= boxes.length;i++){boxes[i].destroy()}boxes.length=0"/>
  -->
</canvas>
<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
