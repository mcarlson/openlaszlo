<!--=======================================================================-->
<!--                                                                       -->
<!-- httpdata.lzx                                                          -->
<!--                                                                       -->
<!-- Laszlo Application Language (LZX) Example                             -->
<!--                                                                       -->
<!--=======================================================================-->

<canvas bgcolor="#EAEAEA" 
        width="640" 
        height="540" 
        debug="true" 
        oninit="debug.setX(30);debug.setY(100)" >
    <include href="redmond" />
    <splash/>
    <datasource type="http" name="http">
        <dataset name="swatch" autorequest="true"
                 getresponseheaders="true"
                 src="swatch.xml"/>
    </datasource>
    
    <view name="dataTest" x="30" y="30" >

        <datapointer name="data" xpath="swatch:/*" ondata="this.processData();" 
                     rerunxpath="true"
                     onerror="this.showError();" 
                     oninit="Debug.write( 'Dataset for ' + this + ' : ' + this.getDataset() )" >
    
            <!-- When data is recieved from the datasource, do this -->
            <method name="processData">
                Debug.write("proc data in : "+ this);
    
                Debug.write("Load time: "+ this.getDataset().getLoadTime());
                <!-- List headers -->
                Debug.write("Date: " +
                            this.getDataset().getResponseHeader('Date'));
                var h = this.getDataset().getAllResponseHeaders();

                Debug.write( h.serialize( '=' , '\n' ) );
                
                this.list();
            </method>
    
            <method name="showError">
                Debug.write("Error: " + this.getDataset().getErrorString());
            </method>
    
            <!-- List nodes heirarchically - like XML, with indentation -->
            <method name="list">
                <!-- List myself and all my children in Debug window -->
                Debug.write( this.serialize() );
            </method>
    
            <method name="publish">
                <!-- Publish myself and all my children -->
                var ds = this.getDataset();
                ds.setAutorequest(false);
                ds.setSrc("swatch.xml");
                ds.setQueryType('POST')
                ds.setAutorequest(true);
                ds.setQueryString({data: this.serialize()})
            </method>
        </datapointer>

        <button label="List data" onclick="this.parent.data.list();"/>

        <button label="Publish data" onclick="this.parent.data.publish();"/>
        
        <button label="Change query" onclick="this.setQuery();">
            <method name="setQuery">
                var ds = canvas.dataTest.data.getDataset();
                ds.setAutorequest(false);
                ds.setSrc("swatch.xml");
                ds.setAutorequest(true);
                ds.setQueryType('POST')
                ds.setQueryString('name=value1')
                ds.setQueryString('name=value2')
                ds.setQueryString('name=value3')
                ds.setQueryString('name=value4')
                ds.setQueryString('name=value5')
                ds.setQueryString('name=value6')
                ds.setQueryString('name=value7')
                ds.setQueryString('name=value8')
                ds.setQueryString('name=value9')
                ds.setQueryString('name=value10')
            </method>
        </button>

        <button label="Abort Load" onclick="this.abort();">
            <method name="abort">
                canvas.dataTest.data.getDataset().abort();
            </method>
        </button>

        <button label="Change URL" onclick="this.setURL();">
            <method name="setURL">
                var ds = canvas.dataTest.data.getDataset();
                ds.setAutorequest(false);
                ds.setSrc('hello.lzx');
                ds.setQueryString('lzt=xml')
                ds.setQueryType('GET')
                ds.doRequest();
            </method>
        </button>

        <simplelayout axis="x" spacing="3"/>
    </view>
</canvas>
<!-- * X_LZ_COPYRIGHT_BEGIN ***************************************************
* Copyright 2001-2004 Laszlo Systems, Inc.  All Rights Reserved.              *
* Use is subject to license terms.                                            *
* X_LZ_COPYRIGHT_END ****************************************************** -->
